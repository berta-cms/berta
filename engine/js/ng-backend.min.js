window.Berta={},((S,i,t)=>{S.sync=function(E,T,i){var r=S.getCookie("token");return i=i||"PATCH",new Promise(function(e){var t,n=5;"function"==typeof S.syncState?e(S.syncState(E,T,i).then(function(e){return JSON.parse(JSON.stringify(e))})):t=setInterval(function(){"function"==typeof S.syncState&&(clearInterval(t),e(S.syncState(E,T,i).then(function(e){return JSON.parse(JSON.stringify(e))}))),0===n&&(clearInterval(t),e(fetch(E,{method:i,credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json","X-Authorization":"Bearer "+r},body:"GET"===i?void 0:JSON.stringify(T)}).then(function(e){if(401===e.status)throw S.BertaHelpers.logoutUser(),new Error("Unauthorized");return e.json()}))),n=-1},200)})},S.getCookie=function(e){for(var t=e+"=",n=i.cookie.split(";"),E=0;E<n.length;E++){for(var T=n[E];" "===T.charAt(0);)T=T.substring(1);if(0===T.indexOf(t))return T.substring(t.length,T.length)}return""},S.getQueryParams=function(){var e=location.search.slice(1).split("&"),t={};return e.forEach(function(e){e[0]&&(e=e.split("="),t[e[0]]=decodeURIComponent(e[1]||""))}),t},S.getCurrentSite=function(){var e=S.getQueryParams();return void 0===e.site?"":e.site},S.escapeHTML=function(e){var t=i.createElement("div"),e=i.createTextNode(e);return t.appendChild(e),t.innerHTML},S.getAllTemplates=function(){var e=t.getState().siteTemplates.toJSON();return Object.getOwnPropertyNames(e)};var e={templates:{}};e.load=function(){var e=i.getElementById("templateList");e&&Array.prototype.slice.call(e.querySelectorAll("script"),0).forEach(function(e){"text/template"===e.getAttribute("type")&&(this.templates[e.getAttribute("id")]=e.innerHTML)}.bind(this))}.bind(e),e.get=function(e,n){return this.templates[e].replace(/<%=([^%>]+)%>/g,function(e,t){return n[t]})}.bind(e),S.Templates=e,S.domReady=function(e){function n(){i.addEventListener?(i.removeEventListener("DOMContentLoaded",t),S.removeEventListener("load",t)):(i.detachEvent("onreadystatechange",t),S.detachEvent("onload",t))}var E=!1,t=function(){E||!i.addEventListener&&"load"!==event.type&&"complete"!==i.readyState||(E=!0,n(),e())};if("complete"===i.readyState)e();else if(i.addEventListener)i.addEventListener("DOMContentLoaded",t),S.addEventListener("load",t);else{i.attachEvent("onreadystatechange",t),S.attachEvent("onload",t);var T=!1;try{T=null===S.frameElement&&i.documentElement}catch(e){}T&&T.doScroll&&!function t(){if(!E){try{T.doScroll("left")}catch(e){return setTimeout(t,50)}E=!0,n(),e()}}()}}})(window,document,window.redux_store),(e=>{e.editables={xEditable:"xEditable",xEditableSelect:"xEditableSelect",xEditableSelectRC:"xEditableSelectRC",xEditableFontSelect:"xEditableFontSelect",xEditableImage:"xEditableImage",xEditableICO:"xEditableICO",xEditableTA:"xEditableTA",xEditableMCE:"xEditableMCE",xEditableMCESimple:"xEditableMCESimple",xEditableRC:"xEditableRC",xEditableYesNo:"xEditableYesNo",xEmpty:"xEmpty"},e.formats={text:e.editables.xEditable,longtext:e.editables.xEditableTA,richtext:e.editables.xEditableMCESimple,image:e.editables.xEditableImage,icon:e.editables.xEditableICO,select:e.editables.xEditableSelectRC,fontselect:e.editables.xEditableFontSelect}})(window),window.ActionTypes={GET_STATE:"GET_STATE",SET_STATE:"SET_STATE",INIT_CREATE_SITE:"INIT_CREATE_SITE",CREATE_SITE:"CREATE_SITE",INIT_UPDATE_SITE:"INIT_UPDATE_SITE",UPDATE_SITE:"UPDATE_SITE",INIT_ORDER_SITES:"INIT_ORDER_SITES",ORDER_SITES:"ORDER_SITES",INIT_DELETE_SITE:"INIT_DELETE_SITE",DELETE_SITE:"DELETE_SITE",CREATE_SITE_SETTINGS:"CREATE_SITE_SETTINGS",INIT_UPDATE_SITE_SETTINGS:"INIT_UPDATE_SITE_SETTINGS",UPDATE_SITE_SETTINGS:"UPDATE_SITE_SETTINGS",RENAME_SITE_SETTINGS_SITENAME:"RENAME_SITE_SETTINGS_SITENAME",INIT_DELETE_SITE_SETTINGS:"INIT_DELETE_SITE_SETTINGS",DELETE_SITE_SETTINGS:"DELETE_SITE_SETTINGS",CREATE_SITE_TEMPLATE_SETTINGS:"CREATE_SITE_TEMPLATE_SETTINGS",INIT_UPDATE_SITE_TEMPLATE_SETTINGS:"INIT_UPDATE_SITE_TEMPLATE_SETTINGS",UPDATE_SITE_TEMPLATE_SETTINGS:"UPDATE_SITE_TEMPLATE_SETTINGS",RENAME_SITE_TEMPLATE_SETTINGS_SITENAME:"RENAME_SITE_TEMPLATE_SETTINGS_SITENAME",INIT_DELETE_SITE_TEMPLATE_SETTINGS:"INIT_DELETE_SITE_TEMPLATE_SETTINGS",DELETE_SITE_TEMPLATE_SETTINGS:"DELETE_SITE_TEMPLATE_SETTINGS",INIT_CREATE_SITE_SECTION:"INIT_CREATE_SITE_SECTION",CREATE_SITE_SECTION:"CREATE_SITE_SECTION",INIT_UPDATE_SITE_SECTION:"INIT_UPDATE_SITE_SECTION",UPDATE_SITE_SECTION:"UPDATE_SITE_SECTION",RENAME_SITE_SECTIONS_SITENAME:"RENAME_SITE_SECTIONS_SITENAME",RESET_SITE_SECTION:"RESET_SITE_SECTION",INIT_ORDER_SITE_SECTIONS:"INIT_ORDER_SITE_SECTIONS",ORDER_SITE_SECTIONS:"ORDER_SITE_SECTIONS",INIT_DELETE_SITE_SECTION:"INIT_DELETE_SITE_SECTION",DELETE_SITE_SECTION:"DELETE_SITE_SECTION",INIT_DELETE_SITE_SECTIONS:"INIT_DELETE_SITE_SECTIONS",DELETE_SITE_SECTIONS:"DELETE_SITE_SECTIONS",INIT_ORDER_SITE_SECTION_BACKGROUNDS:"INIT_ORDER_SITE_SECTION_BACKGROUNDS",ORDER_SITE_SECTION_BACKGROUNDS:"ORDER_SITE_SECTION_BACKGROUNDS",INIT_DELETE_SITE_SECTION_BACKGROUND:"INIT_DELETE_SITE_SECTION_BACKGROUND",DELETE_SITE_SECTION_BACKGROUND:"DELETE_SITE_SECTION_BACKGROUND",ADD_SECTION_TAGS:"ADD_SECTION_TAGS",ADD_SITE_SECTIONS_TAGS:"ADD_SITE_SECTIONS_TAGS",INIT_ORDER_SECTION_TAGS:"INIT_ORDER_SECTION_TAGS",ORDER_SECTION_TAGS:"ORDER_SECTION_TAGS",INIT_UPDATE_SECTION_TAGS:"INIT_UPDATE_SECTION_TAGS",UPDATE_SECTION_TAGS:"UPDATE_SECTION_TAGS",RENAME_SECTION_TAGS:"RENAME_SECTION_TAGS",RENAME_SECTION_TAGS_SITENAME:"RENAME_SECTION_TAGS_SITENAME",DELETE_SECTION_TAGS:"DELETE_SECTION_TAGS",INIT_DELETE_SITE_SECTIONS_TAGS:"INIT_DELETE_SITE_SECTIONS_TAGS",DELETE_SITE_SECTIONS_TAGS:"DELETE_SITE_SECTIONS_TAGS",ADD_SITE_SECTIONS_ENTRIES:"ADD_SITE_SECTIONS_ENTRIES",ADD_SECTION_ENTRIES:"ADD_SECTION_ENTRIES",INIT_CREATE_SECTION_ENTRY:"INIT_CREATE_SECTION_ENTRY",INIT_UPDATE_SECTION_ENTRY:"INIT_UPDATE_SECTION_ENTRY",UPDATE_SECTION_ENTRY:"UPDATE_SECTION_ENTRY",INIT_UPDATE_SECTION_ENTRIES:"INIT_UPDATE_SECTION_ENTRIES",INIT_MOVE_ENTRY_TO_SECTION:"INIT_MOVE_ENTRY_TO_SECTION",RENAME_SECTION_ENTRIES_SITENAME:"RENAME_SECTION_ENTRIES_SITENAME",RENAME_SECTION_ENTRIES:"RENAME_SECTION_ENTRIES",INIT_ORDER_SECTION_ENTRIES:"INIT_ORDER_SECTION_ENTRIES",ORDER_SECTION_ENTRIES:"ORDER_SECTION_ENTRIES",INIT_ORDER_SECTION_ENTRY_GALLERY:"INIT_ORDER_SECTION_ENTRY_GALLERY",ORDER_SECTION_ENTRY_GALLERY:"ORDER_SECTION_ENTRY_GALLERY",INIT_DELETE_ENTRY_GALLERY_IMAGE:"INIT_DELETE_ENTRY_GALLERY_IMAGE",DELETE_ENTRY_GALLERY_IMAGE:"DELETE_ENTRY_GALLERY_IMAGE",INIT_DELETE_SECTION_ENTRY:"INIT_DELETE_SECTION_ENTRY",DELETE_SECTION_ENTRY:"DELETE_SECTION_ENTRY",INIT_DELETE_SITE_SECTIONS_ENTRIES:"INIT_DELETE_SITE_SECTIONS_ENTRIES",DELETE_SITE_SECTIONS_ENTRIES:"DELETE_SITE_SECTIONS_ENTRIES",INIT_DELETE_SECTION_ENTRIES:"INIT_DELETE_SECTION_ENTRIES",DELETE_SECTION_ENTRIES:"DELETE_SECTION_ENTRIES"},((E,t,T,i)=>{E.Actions=E.Actions||{},Object.assign(E.Actions,{getState:function(e){var n="/_api/v1/state/"+(e=e||"0");return function(t){t({type:T.GET_STATE}),i(n,{},"GET").then(function(e){e.error_message||t(E.Actions.setState(e))})}},setState:function(e){return t.urls=e.urls,{type:T.SET_STATE,state:e}}})})(window,window.Berta,window.ActionTypes,window.sync),((S,a,_)=>{var s=S.Actions=S.Actions||{};Object.assign(S.Actions,{initCreateSite:function(e,E){return function(n){n({type:a.INIT_CREATE_SITE}),_(S.Berta.urls.sites,{site:e},"POST").then(function(e){if(!e.error_message){if(n(s.createSite(e.site)),e.settings&&n(s.createSiteSettings(e.site.name,e.settings)),e.sections&&e.sections.length)for(var t=0;t<e.sections.length;t++)n(s.createSiteSection(e.sections[t]));e.entries&&e.entries.length&&n(s.addSiteSectionsEntries({site_name:e.site.name,entries:e.entries})),e.tags&&e.tags.section&&n(s.addSiteSectionsTags({site_name:e.site.name,tags:e.tags})),e.siteTemplateSettings&&n(s.createSiteTemplateSettings(e.site.name,e.siteTemplateSettings))}E(e.site)})}},createSite:function(e){return{type:a.CREATE_SITE,data:e}},initUpdateSite:function(e,n,E){return function(t){t({type:a.INIT_UPDATE_SITE}),_(S.Berta.urls.sites,{path:e,value:n}).then(function(e){e.error_message||t(s.updateSite(e)),E(e)})}},updateSite:function(e){return{type:a.UPDATE_SITE,resp:e}},renameSite:function(i,e,r){return function(E,T){E({type:a.INIT_UPDATE_SITE}),E({type:a.INIT_UPDATE_SITE_SECTION}),E({type:a.INIT_UPDATE_SITE_SETTINGS}),E({type:a.INIT_UPDATE_SITE_TEMPLATE_SETTINGS}),E({type:a.INIT_UPDATE_SECTION_TAGS}),E({type:a.INIT_UPDATE_SECTION_ENTRIES}),_(S.Berta.urls.sites,{path:i,value:e}).then(function(e){var t,n;e.error_message||(i=i.split("/"),t=parseInt(i[1],10),n=T().sites.find(function(e){return e.get("order")===t}),E(s.updateSite(e)),E(s.renameSiteSectionsSitename({site:n,site_name:e.value})),E(s.renameSiteSettingsSitename({site:n,site_name:e.value})),E(s.renameSiteTemplateSettingsSitename({site:n,site_name:e.value})),E(s.renameSectionTagsSitename({site:n,site_name:e.value})),E(s.renameSectionEntriesSitename({site:n,site_name:e.value}))),r(e)})}},initOrderSites:function(n,E){return function(t){t({type:a.INIT_ORDER_SITES}),_(S.Berta.urls.sites,n,"PUT").then(function(e){e.error_message||t(s.orderSites(n)),E(e)})}},orderSites:function(e){return{type:a.ORDER_SITES,resp:e}},initdeleteSite:function(e,n){return function(t){t({type:a.INIT_DELETE_SITE}),t({type:a.INIT_DELETE_SITE_SECTIONS}),t({type:a.INIT_DELETE_SITE_SETTINGS}),t({type:a.INIT_DELETE_SITE_TEMPLATE_SETTINGS}),t({type:a.INIT_DELETE_SITE_SECTIONS_TAGS}),t({type:a.INIT_DELETE_SITE_SECTIONS_ENTRIES}),_(S.Berta.urls.sites,{site:e},"DELETE").then(function(e){e.error_message||(t(s.deleteSite(e)),t(s.deleteSiteSections({site_name:e.name})),t(s.deleteSiteSettings({site_name:e.name})),t(s.deleteSiteTemplateSettings({site_name:e.name})),t(s.deleteSiteSectionsTags({site_name:e.name})),t(s.deleteSiteSectionsEntries({site_name:e.name}))),n(e)})}},deleteSite:function(e){return{type:a.DELETE_SITE,resp:e}}})})(window,window.ActionTypes,window.sync),((e,r,S)=>{e.reducers=e.reducers||{},Object.assign(e.reducers,{sites:function(e,n){switch(void 0===e&&(e=r.Map()),n.type){case S.SET_STATE:return r.fromJS(n.state.sites);case S.CREATE_SITE:return e.set(e.size,r.fromJS(n.data));case S.UPDATE_SITE:var t=n.resp.path.split("/"),E=parseInt(t[1],10),T=n.resp.value,i=t.slice(2);return e.map(function(e){return e.get("order")===E&&e.getIn(i)!==T?e.setIn(i,T):e});case S.ORDER_SITES:return e.map(function(e){var t=e.get("name"),t=n.resp.indexOf(t=""===t?"0":t);return e.get("order")!==t?e.set("order",t):e});case S.DELETE_SITE:return e.filter(function(e){return e.get("name")!==n.resp.name}).map(function(e,t){return e.get("order")!==t?e.set("order",t):e});default:return e}}})})(window,window.Immutable,window.ActionTypes),((T,i,r)=>{var S=T.Actions=T.Actions||{};Object.assign(T.Actions,{createSiteSettings:function(e,t){return{type:i.CREATE_SITE_SETTINGS,site_name:e,data:t}},initUpdateSiteSettings:function(e,n,E){return function(t){t({type:i.INIT_UPDATE_SITE_SETTINGS}),r(T.Berta.urls.siteSettings,{path:e,value:n}).then(function(e){e.error_message||t(S.updateSiteSettings(e)),E(e)})}},updateSiteSettings:function(e){return{type:i.UPDATE_SITE_SETTINGS,resp:e}},renameSiteSettingsSitename:function(e){return{type:i.RENAME_SITE_SETTINGS_SITENAME,data:e}},deleteSiteSettings:function(e){return{type:i.DELETE_SITE_SETTINGS,data:e}}})})(window,window.ActionTypes,window.sync),((e,i,r)=>{e.reducers=e.reducers||{},Object.assign(e.reducers,{siteSettings:function(e,n){switch(void 0===e&&(e=i.Map()),n.type){case r.SET_STATE:return i.fromJS(n.state.site_settings);case r.CREATE_SITE_SETTINGS:return e.setIn([n.site_name],i.fromJS(n.data));case r.UPDATE_SITE_SETTINGS:var t=n.resp.path.split("/").slice(2),E=n.resp.value;return e.setIn([n.resp.site,t[0],t[1]],E);case r.RENAME_SITE_SETTINGS_SITENAME:var T=n.data.site.get("name");return e.mapKeys(function(e){return e===T?n.data.site_name:e});case r.DELETE_SITE_SETTINGS:return e.filter(function(e,t){return t!==n.data.site_name});default:return e}}})})(window,window.Immutable,window.ActionTypes),((T,i,r)=>{var S=T.Actions=T.Actions||{};Object.assign(T.Actions,{createSiteTemplateSettings:function(e,t){return{type:i.CREATE_SITE_TEMPLATE_SETTINGS,site_name:e,data:t}},initUpdateSiteTemplateSettings:function(e,n,E){return function(t){t({type:i.INIT_UPDATE_SITE_TEMPLATE_SETTINGS}),r(T.Berta.urls.siteTemplateSettings,{path:e,value:n}).then(function(e){e.error_message||t(S.updateSiteTemplateSettings(e)),E(e)})}},updateSiteTemplateSettings:function(e){return{type:i.UPDATE_SITE_TEMPLATE_SETTINGS,resp:e}},renameSiteTemplateSettingsSitename:function(e){return{type:i.RENAME_SITE_TEMPLATE_SETTINGS_SITENAME,data:e}},deleteSiteTemplateSettings:function(e){return{type:i.DELETE_SITE_TEMPLATE_SETTINGS,data:e}}})})(window,window.ActionTypes,window.sync),((e,i,r)=>{e.reducers=e.reducers||{},Object.assign(e.reducers,{siteTemplateSettings:function(e,n){switch(void 0===e&&(e=i.Map()),n.type){case r.SET_STATE:return i.fromJS(n.state.site_template_settings);case r.CREATE_SITE_TEMPLATE_SETTINGS:return e.setIn([n.site_name],i.fromJS(n.data));case r.UPDATE_SITE_TEMPLATE_SETTINGS:var t=n.resp.path.split("/").slice(2),E=n.resp.value;return e.setIn([n.resp.site,t[0],t[1],t[2]],E);case r.RENAME_SITE_TEMPLATE_SETTINGS_SITENAME:var T=n.data.site.get("name");return e.mapKeys(function(e){return e===T?n.data.site_name:e});case r.DELETE_SITE_TEMPLATE_SETTINGS:return e.filter(function(e,t){return t!==n.data.site_name});default:return e}}})})(window,window.Immutable,window.ActionTypes),((i,r,S)=>{var a=i.Actions=i.Actions||{};Object.assign(i.Actions,{initCreateSiteSection:function(n,e,E,T){return function(t){t({type:r.INIT_CREATE_SITE_SECTION}),t({type:r.INIT_UPDATE_SECTION_TAGS}),S(i.Berta.urls.siteSections,{site:n,name:e,title:E},"POST").then(function(e){e.error_message||(t(a.createSiteSection(e.section)),e.tags&&t(a.addSectionTags({site_name:n,tags:e.tags})),e.entries&&t(a.addSectionEntries({site_name:n,entries:e.entries}))),T(e.section)})}},createSiteSection:function(e){return{type:r.CREATE_SITE_SECTION,resp:e}},initUpdateSiteSection:function(e,n,E){return function(t){t({type:r.INIT_UPDATE_SITE_SECTION}),S(i.Berta.urls.siteSections,{path:e,value:n}).then(function(e){e.error_message||t(a.updateSiteSection(e)),E(e)})}},updateSiteSection:function(e){return{type:r.UPDATE_SITE_SECTION,resp:e}},initRenameSiteSection:function(e,n,E){return function(t){t({type:r.INIT_UPDATE_SITE_SECTION}),t({type:r.INIT_UPDATE_SECTION_TAGS}),t({type:r.INIT_UPDATE_SECTION_ENTRIES}),S(i.Berta.urls.siteSections,{path:e,value:n}).then(function(e){e.error_message||(t(a.updateSiteSection(e)),t(a.renameSectionTags({site_name:e.site,section_name:e.section.name,section_old_name:e.old_name})),t(a.renameSectionEntries({site_name:e.site,section_name:e.section.name,section_old_name:e.old_name}))),E(e)})}},renameSiteSectionsSitename:function(e){return{type:r.RENAME_SITE_SECTIONS_SITENAME,data:e}},resetSiteSection:function(t,n){return function(e){e({type:r.RESET_SITE_SECTION,path:t}),S(i.Berta.urls.siteSectionsReset,{path:t}).then(function(e){e.error_message,n(e)})}},initOrderSiteSections:function(n,E,T){return function(t){t({type:r.INIT_ORDER_SITE_SECTIONS}),S(i.Berta.urls.siteSections,{site:n,sections:E},"PUT").then(function(e){e.error_message||t(a.orderSiteSections({site:n,sections:E})),T(e)})}},orderSiteSections:function(e){return{type:r.ORDER_SITE_SECTIONS,resp:e}},initDeleteSiteSection:function(e,n,E){return function(t){t({type:r.INIT_DELETE_SITE_SECTION}),t({type:r.INIT_UPDATE_SECTION_TAGS}),t({type:r.INIT_DELETE_SECTION_ENTRIES}),S(i.Berta.urls.siteSections,{site:e,section:n},"DELETE").then(function(e){e.error_message||(t(a.deleteSiteSection(e)),t(a.deleteSectionTags({site_name:e.site,section_name:e.name})),t(a.deleteSectionEntries({site_name:e.site,section_name:e.name}))),E(e)})}},deleteSiteSection:function(e){return{type:r.DELETE_SITE_SECTION,resp:e}},deleteSiteSections:function(e){return{type:r.DELETE_SITE_SECTIONS,data:e}},initOrderSiteSectionBackgrounds:function(e,n,E,T){return function(t){t({type:r.INIT_ORDER_SITE_SECTION_BACKGROUNDS}),S(i.Berta.urls.siteSectionBackgrounds,{site:e,section:n,files:E},"PUT").then(function(e){e.error_message||t(a.orderSiteSectionBackgrounds(e)),T(e)})}},orderSiteSectionBackgrounds:function(e){return{type:r.ORDER_SITE_SECTION_BACKGROUNDS,resp:e}},initDeleteSiteSectionBackground:function(e,n,E,T){return function(t){t({type:r.INIT_DELETE_SITE_SECTION_BACKGROUND}),S(i.Berta.urls.siteSectionBackgrounds,{site:e,section:n,file:E},"DELETE").then(function(e){e.error_message||t(a.deleteSiteSectionBackground(e)),T(e)})}},deleteSiteSectionBackground:function(e){return{type:r.DELETE_SITE_SECTION_BACKGROUND,resp:e}}})})(window,window.ActionTypes,window.sync),((e,a,_)=>{e.reducers=e.reducers||{},Object.assign(e.reducers,{siteSections:function(e,n){var t,E,T,i;switch(void 0===e&&(e=a.Map()),n.type){case _.SET_STATE:return a.fromJS(n.state.site_sections);case _.CREATE_SITE_SECTION:return e.set(e.size,a.fromJS(n.resp));case _.UPDATE_SITE_SECTION:return t=n.resp.path.split("/"),E="0"===t[0]?"":t[0],T=parseInt(t[2],10),S=n.resp.value,i=t.slice(3),e.map(function(e){return e.get("site_name")===E&&e.get("order")===T&&e.getIn(i)!==S?e.merge(n.resp.section):e});case _.RENAME_SITE_SECTIONS_SITENAME:var r=n.data.site.get("name"),S=n.data.site_name;return e.map(function(e){return e.get("site_name")===r?e.set("site_name",S):e});case _.RESET_SITE_SECTION:return t=n.path.split("/"),E="0"===t[0]?"":t[0],T=parseInt(t[2],10),i=t.slice(3),e.map(function(e){return e.get("site_name")===E&&e.get("order")===T?e.deleteIn(i):e});case _.ORDER_SITE_SECTIONS:return e.map(function(e){if(e.get("site_name")===n.resp.site){var t=n.resp.sections.indexOf(e.get("name"));if(e.get("order")!==t)return e.set("order",t)}return e});case _.DELETE_SITE_SECTION:return E="0"===n.resp.site?"":n.resp.site,T=-1,e.filter(function(e){return!(e.get("name")===n.resp.name&&e.get("site_name")===E)}).map(function(e){return e.get("site_name")===E&&(T++,e.get("order")!==T)?e.set("order",T):e});case _.DELETE_SITE_SECTIONS:return e.filter(function(e){return e.get("site_name")!==n.data.site_name});case _.ORDER_SITE_SECTION_BACKGROUNDS:return e.map(function(e){return e.get("site_name")===n.resp.site&&e.get("name")===n.resp.section?e.set("mediafolder",n.resp.mediafolder).setIn(["mediaCacheData","file"],n.resp.files):e});default:return e}}})})(window,window.Immutable,window.ActionTypes),((r,S,a)=>{var _=r.Actions=r.Actions||{};Object.assign(r.Actions,{addSiteSectionsTags:function(e){return{type:S.ADD_SITE_SECTIONS_TAGS,data:e}},addSectionTags:function(e){return{type:S.ADD_SECTION_TAGS,data:e}},initOrderSectionTags:function(e,n,E,T,i){return function(t){t({type:S.INIT_ORDER_SECTION_TAGS}),a(r.Berta.urls.sectionTags,{site:e,section:n,tag:E,value:T},"PUT").then(function(e){e.error_message||t(_.orderSectionTags(e)),i()})}},orderSectionTags:function(e){return{type:S.ORDER_SECTION_TAGS,data:e}},renameSectionTags:function(e){return{type:S.RENAME_SECTION_TAGS,data:e}},updateSectionTags:function(e){return{type:S.UPDATE_SECTION_TAGS,data:e}},renameSectionTagsSitename:function(e){return{type:S.RENAME_SECTION_TAGS_SITENAME,data:e}},deleteSectionTags:function(e){return{type:S.DELETE_SECTION_TAGS,data:e}},deleteSiteSectionsTags:function(e){return{type:S.DELETE_SITE_SECTIONS_TAGS,data:e}}})})(window,window.ActionTypes,window.sync),((e,T,i)=>{e.reducers=e.reducers||{},Object.assign(e.reducers,{sectionTags:function(e,n){var E=[];switch(void 0===e&&(e=T.Map()),n.type){case i.SET_STATE:return T.fromJS(n.state.section_tags);case i.ADD_SITE_SECTIONS_TAGS:return e.set(n.data.site_name,n.data.tags);case i.ADD_SECTION_TAGS:return e.map(function(e,t){return n.data.site_name===t?e.map(function(e){return e.set(e.size,T.fromJS(n.data.tags))}):e});case i.ORDER_SECTION_TAGS:return E="0"===n.data.site_name?"":n.data.site_name,e.map(function(e,t){return E===t?e.map(function(e){return e.map(function(e){var t;return e.getIn(["@attributes","name"])===n.data.section_name?(t=e.get("tag").map(function(e){return e.set("order",n.data.order.indexOf(e.getIn(["@attributes","name"])))}),e.set("tag",t)):e})}):e});case i.UPDATE_SECTION_TAGS:return E="0"===n.data.site_name?"":n.data.site_name,e.map(function(e,t){return E===t?e.map(function(e){return e.some(function(e){return e&&e.getIn(["@attributes","name"])===n.data.section_name})?e.map(function(e){return e.getIn(["@attributes","name"])===n.data.section_name?e.merge(n.data.tags):e}):n.data.tags?e.set(e.size,T.fromJS(n.data.tags)):e}):e});case i.RENAME_SECTION_TAGS:return E="0"===n.data.site_name?"":n.data.site_name,e.map(function(e,t){return E===t?e.map(function(e){return e.map(function(e){return e.getIn(["@attributes","name"])===n.data.section_old_name?e.setIn(["@attributes","name"],n.data.section_name):e})}):e});case i.RENAME_SECTION_TAGS_SITENAME:var t=n.data.site.get("name");return e.mapKeys(function(e){return e===t?n.data.site_name:e});case i.DELETE_SECTION_TAGS:return E="0"===n.data.site_name?"":n.data.site_name,e.map(function(e,t){return E===t?e.map(function(e){return e.filter(function(e){return e.getIn(["@attributes","name"])!==n.data.section_name})}):e});case i.DELETE_SITE_SECTIONS_TAGS:return e.filter(function(e,t){return t!==n.data.site_name});default:return e}}})})(window,window.Immutable,window.ActionTypes),((r,S,a,_)=>{r.Actions=r.Actions||{},Object.assign(r.Actions,{initCreateSectionEntry:function(t,n,E,T,i){return function(e){e({type:_.INIT_CREATE_SECTION_ENTRY}),S(r.Berta.urls.sectionEntries,{site:t,section:n,tag:E,before_entry:T},"POST").then(function(e){i(e)})}},addSiteSectionsEntries:function(e){return{type:_.ADD_SITE_SECTIONS_ENTRIES,data:e}},addSectionEntries:function(e){return{type:_.ADD_SECTION_ENTRIES,data:e}},initUpdateSectionEntry:function(e,n,E){return function(t){t({type:_.INIT_UPDATE_SECTION_ENTRY}),S(r.Berta.urls.sectionEntries,{path:e,value:n}).then(function(e){e.error_message||(t(a.updateSectionEntry(e)),e.section&&(t({type:_.INIT_UPDATE_SITE_SECTION}),t(a.updateSiteSection({path:e.site_name+"/section/"+e.section_order+"/@attributes/has_direct_content",section:e.section,value:e.has_direct_content}))),e.tags&&t(a.updateSectionTags(e))),E&&E(e)})}},updateSectionEntry:function(e){return{type:_.UPDATE_SECTION_ENTRY,resp:e}},renameSectionEntriesSitename:function(e){return{type:_.RENAME_SECTION_ENTRIES_SITENAME,data:e}},renameSectionEntries:function(e){return{type:_.RENAME_SECTION_ENTRIES,data:e}},initOrderSectionEntries:function(e,n,E,T){return function(t){t({type:_.INIT_ORDER_SECTION_ENTRIES}),S(r.Berta.urls.sectionEntries,{site:e,section:n,entryId:E,value:T},"PUT").then(function(e){e.error_message||t(a.orderSectionEntries(e))})}},orderSectionEntries:function(e){return{type:_.ORDER_SECTION_ENTRIES,data:e}},initEntryMoveToSection:function(t,n,E,T,i){return function(e){e({type:_.INIT_MOVE_ENTRY_TO_SECTION}),S(r.Berta.urls.sectionEntriesMove,{site:t,currentSection:n,entryId:E,toSection:T}).then(i)}},initDeleteSectionEntry:function(e,n,E,T){return function(t){t({type:_.INIT_DELETE_SECTION_ENTRY}),t({type:_.INIT_UPDATE_SITE_SECTION}),S(r.Berta.urls.sectionEntries,{site:e,section:n,entryId:E},"DELETE").then(function(e){e.error_message||(t(a.deleteSectionEntry(e)),t(a.updateSiteSection({path:e.site_name+"/section/"+e.section_order+"/@attributes/entry_count",section:e.section,value:e.entry_count})),t(a.updateSiteSection({path:e.site_name+"/section/"+e.section_order+"/@attributes/has_direct_content",section:e.section,value:e.has_direct_content})),t(a.updateSectionTags(e))),T(e)})}},deleteSectionEntry:function(e){return{type:_.DELETE_SECTION_ENTRY,resp:e}},deleteSiteSectionsEntries:function(e){return{type:_.DELETE_SITE_SECTIONS_ENTRIES,data:e}},deleteSectionEntries:function(e){return{type:_.DELETE_SECTION_ENTRIES,data:e}},initOrderSectionEntryGallery:function(e,n,E,T,i){return function(t){t({type:_.INIT_ORDER_SECTION_ENTRY_GALLERY}),S(r.Berta.urls.entryGallery,{site:e,section:n,entryId:E,files:T},"PUT").then(function(e){e.error_message||t(a.orderSectionEntryGallery(e)),i(e)})}},orderSectionEntryGallery:function(e){return{type:_.ORDER_SECTION_ENTRY_GALLERY,resp:e}},initDeleteEntryGalleryImage:function(e,n,E,T,i){return function(t){t({type:_.INIT_DELETE_ENTRY_GALLERY_IMAGE}),S(r.Berta.urls.entryGallery,{site:e,section:n,entryId:E,file:T},"DELETE").then(function(e){e.error_message||t(a.deleteEntryGalleryImage(e)),i(e)})}},deleteEntryGalleryImage:function(e){return{type:_.DELETE_ENTRY_GALLERY_IMAGE,resp:e}}})})(window,window.sync,window.Actions,window.ActionTypes),((e,a,_)=>{e.reducers=e.reducers||{},Object.assign(e.reducers,{sectionEntries:function(e,E){var T;switch(void 0===e&&(e=a.Map()),E.type){case _.SET_STATE:return a.fromJS(E.state.sectionEntries);case _.ADD_SITE_SECTIONS_ENTRIES:return e.set(E.data.site_name,E.data.entries);case _.ADD_SECTION_ENTRIES:return e.map(function(e,t){return t===E.data.site_name?e.concat(a.fromJS(E.data.entries)):e});case _.UPDATE_SECTION_ENTRY:var t=E.resp.path.split("/"),n="0"===t[0]?"":t[0],i=t[2],r=t[3],t=e.get(n).findIndex(function(e){return e.get("id")===r&&e.get("sectionName")===i});return t<0?e:e.setIn([n,t],e.getIn([n,t]).merge(E.resp.entry));case _.RENAME_SECTION_ENTRIES_SITENAME:var S=E.data.site.get("name");return e.mapKeys(function(e){return e===S?E.data.site_name:e});case _.RENAME_SECTION_ENTRIES:return T="0"===E.data.site_name?"":E.data.site_name,e.map(function(e,t){return T===t?e.map(function(e){return e.get("sectionName")===E.data.section_old_name?e.set("sectionName",E.data.section_name):e}):e});case _.ORDER_SECTION_ENTRIES:return T="0"===E.data.site_name?"":E.data.site_name,e.map(function(e,t){return T===t?e.map(function(e){return e.get("sectionName")===E.data.section_name?e.set("order",E.data.order.indexOf(e.get("id"))):e}):e});case _.DELETE_SECTION_ENTRY:return T="0"===E.resp.site_name?"":E.resp.site_name,e.map(function(e,t){var n;return T===t?(n=e.find(function(e){return e.get("sectionName")===E.resp.section_name&&e.get("id")===E.resp.entry_id}),e.filter(function(e){return!(e.get("sectionName")===E.resp.section_name&&e.get("id")===E.resp.entry_id)}).map(function(e){return e.get("sectionName")===E.resp.section_name&&e.get("order")>n.get("order")?e.set("order",e.get("order")-1):e})):e});case _.DELETE_SITE_SECTIONS_ENTRIES:return e.filter(function(e,t){return t!==E.data.site_name});case _.DELETE_SECTION_ENTRIES:return T="0"===E.data.site_name?"":E.data.site_name,e.map(function(e,t){return T===t?e.filter(function(e){return e.get("sectionName")!==E.data.section_name}):e});case _.ORDER_SECTION_ENTRY_GALLERY:return e.map(function(e,t){return t===E.resp.site?e.map(function(e){return e.get("sectionName")===E.resp.section&&e.get("id")===E.resp.entry_id?e.set("mediafolder",E.resp.mediafolder).setIn(["mediaCacheData","file"],E.resp.files):e}):e});default:return e}}})})(window,window.Immutable,window.ActionTypes),((e,n,E)=>{e.reducers=e.reducers||{},Object.assign(e.reducers,{siteTemplates:function(e,t){return void 0===e&&(e=n.Map()),t.type!==E.SET_STATE?e:n.fromJS(t.state.siteTemplates)}})})(window,window.Immutable,window.ActionTypes),((e,t)=>{e.root_reducer=t.combineReducers(window.reducers)})(window,window.Redux),((e,t,n,E,T,i)=>{T(window.Templates.load),T=e.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||t.compose,e.redux_store=t.createStore(e.root_reducer,{},T(t.applyMiddleware(n.default))),T=i(),e.redux_store.dispatch(E.getState(T))})(window,window.Redux,window.ReduxThunk,window.Actions,window.domReady,window.getCurrentSite);
//# sourceMappingURL=maps/ng-backend.min.js.map
