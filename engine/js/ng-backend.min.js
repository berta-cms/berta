window.Berta={},function(e,t,n){"use strict";e.sync=function(t,n,E){var i=e.getCookie("token");return E=E||"PATCH",fetch(t,{method:E,credentials:"include",headers:{Accept:"application/json","Content-Type":"application/json","X-Authorization":"Bearer "+i},body:"GET"===E?void 0:JSON.stringify(n)}).then(function(t){if(401===t.status)throw e.BertaHelpers.logoutUser(),new Error("Unauthorized");return t.json()})["catch"](function(e){console.error("Request failed:",e.message)})},e.getCookie=function(e){for(var n=e+"=",E=t.cookie.split(";"),i=0;i<E.length;i++){for(var T=E[i];" "===T.charAt(0);)T=T.substring(1);if(0===T.indexOf(n))return T.substring(n.length,T.length)}return""},e.getQueryParams=function(){var e=location.search.slice(1).split("&"),t={};return e.forEach(function(e){e[0]&&(e=e.split("="),t[e[0]]=decodeURIComponent(e[1]||""))}),t},e.getCurrentSite=function(){var t=e.getQueryParams();return void 0===t.site?"":t.site},e.escapeHTML=function(e){var n=t.createElement("div"),E=t.createTextNode(e);return n.appendChild(E),n.innerHTML},e.getAllTemplates=function(){var e=n.getState().siteTemplates.toJSON();return Object.getOwnPropertyNames(e)};var E={templates:{}};E.load=function(){var e=t.getElementById("templateList");if(e){var n=Array.prototype.slice.call(e.querySelectorAll("script"),0);n.forEach(function(e){"text/template"===e.getAttribute("type")&&(this.templates[e.getAttribute("id")]=e.innerHTML)}.bind(this))}}.bind(E),E.get=function(e,t){var n=this.templates[e];return n.replace(/<%=([^%>]+)%>/g,function(e,n){return t[n]})}.bind(E),e.Templates=E,e.domReady=function(n){var E=!1,i=function(){t.addEventListener?(t.removeEventListener("DOMContentLoaded",T),e.removeEventListener("load",T)):(t.detachEvent("onreadystatechange",T),e.detachEvent("onload",T))},T=function(){E||!t.addEventListener&&"load"!==event.type&&"complete"!==t.readyState||(E=!0,i(),n())};if("complete"===t.readyState)n();else if(t.addEventListener)t.addEventListener("DOMContentLoaded",T),e.addEventListener("load",T);else{t.attachEvent("onreadystatechange",T),e.attachEvent("onload",T);var r=!1;try{r=null===e.frameElement&&t.documentElement}catch(S){}r&&r.doScroll&&!function a(){if(!E){try{r.doScroll("left")}catch(e){return setTimeout(a,50)}E=!0,i(),n()}}()}}}(window,document,window.redux_store),function(e){"use strict";e.editables={xEditable:"xEditable",xEditableColor:"xEditableColor",xEditableSelect:"xEditableSelect",xEditableSelectRC:"xEditableSelectRC",xEditableFontSelect:"xEditableFontSelect",xEditableImage:"xEditableImage",xEditableICO:"xEditableICO",xEditableTA:"xEditableTA",xEditableMCE:"xEditableMCE",xEditableMCESimple:"xEditableMCESimple",xEditableRC:"xEditableRC",xEditableYesNo:"xEditableYesNo",xEmpty:"xEmpty"},e.formats={text:e.editables.xEditable,longtext:e.editables.xEditableTA,richtext:e.editables.xEditableMCESimple,color:e.editables.xEditableColor,image:e.editables.xEditableImage,icon:e.editables.xEditableICO,select:e.editables.xEditableSelectRC,fontselect:e.editables.xEditableFontSelect}}(window),function(e){"use strict";e.ActionTypes={GET_STATE:"GET_STATE",SET_STATE:"SET_STATE",INIT_CREATE_SITE:"INIT_CREATE_SITE",CREATE_SITE:"CREATE_SITE",INIT_UPDATE_SITE:"INIT_UPDATE_SITE",UPDATE_SITE:"UPDATE_SITE",INIT_ORDER_SITES:"INIT_ORDER_SITES",ORDER_SITES:"ORDER_SITES",INIT_DELETE_SITE:"INIT_DELETE_SITE",DELETE_SITE:"DELETE_SITE",CREATE_SITE_SETTINGS:"CREATE_SITE_SETTINGS",INIT_UPDATE_SITE_SETTINGS:"INIT_UPDATE_SITE_SETTINGS",UPDATE_SITE_SETTINGS:"UPDATE_SITE_SETTINGS",RENAME_SITE_SETTINGS_SITENAME:"RENAME_SITE_SETTINGS_SITENAME",INIT_DELETE_SITE_SETTINGS:"INIT_DELETE_SITE_SETTINGS",DELETE_SITE_SETTINGS:"DELETE_SITE_SETTINGS",CREATE_SITE_TEMPLATE_SETTINGS:"CREATE_SITE_TEMPLATE_SETTINGS",INIT_UPDATE_SITE_TEMPLATE_SETTINGS:"INIT_UPDATE_SITE_TEMPLATE_SETTINGS",UPDATE_SITE_TEMPLATE_SETTINGS:"UPDATE_SITE_TEMPLATE_SETTINGS",RENAME_SITE_TEMPLATE_SETTINGS_SITENAME:"RENAME_SITE_TEMPLATE_SETTINGS_SITENAME",INIT_DELETE_SITE_TEMPLATE_SETTINGS:"INIT_DELETE_SITE_TEMPLATE_SETTINGS",DELETE_SITE_TEMPLATE_SETTINGS:"DELETE_SITE_TEMPLATE_SETTINGS",INIT_CREATE_SITE_SECTION:"INIT_CREATE_SITE_SECTION",CREATE_SITE_SECTION:"CREATE_SITE_SECTION",INIT_UPDATE_SITE_SECTION:"INIT_UPDATE_SITE_SECTION",UPDATE_SITE_SECTION:"UPDATE_SITE_SECTION",RENAME_SITE_SECTIONS_SITENAME:"RENAME_SITE_SECTIONS_SITENAME",RESET_SITE_SECTION:"RESET_SITE_SECTION",INIT_ORDER_SITE_SECTIONS:"INIT_ORDER_SITE_SECTIONS",ORDER_SITE_SECTIONS:"ORDER_SITE_SECTIONS",INIT_DELETE_SITE_SECTION:"INIT_DELETE_SITE_SECTION",DELETE_SITE_SECTION:"DELETE_SITE_SECTION",INIT_DELETE_SITE_SECTIONS:"INIT_DELETE_SITE_SECTIONS",DELETE_SITE_SECTIONS:"DELETE_SITE_SECTIONS",INIT_ORDER_SITE_SECTION_BACKGROUNDS:"INIT_ORDER_SITE_SECTION_BACKGROUNDS",ORDER_SITE_SECTION_BACKGROUNDS:"ORDER_SITE_SECTION_BACKGROUNDS",INIT_DELETE_SITE_SECTION_BACKGROUND:"INIT_DELETE_SITE_SECTION_BACKGROUND",DELETE_SITE_SECTION_BACKGROUND:"DELETE_SITE_SECTION_BACKGROUND",ADD_SECTION_TAGS:"ADD_SECTION_TAGS",ADD_SITE_SECTIONS_TAGS:"ADD_SITE_SECTIONS_TAGS",INIT_ORDER_SECTION_TAGS:"INIT_ORDER_SECTION_TAGS",ORDER_SECTION_TAGS:"ORDER_SECTION_TAGS",INIT_UPDATE_SECTION_TAGS:"INIT_UPDATE_SECTION_TAGS",UPDATE_SECTION_TAGS:"UPDATE_SECTION_TAGS",RENAME_SECTION_TAGS:"RENAME_SECTION_TAGS",RENAME_SECTION_TAGS_SITENAME:"RENAME_SECTION_TAGS_SITENAME",DELETE_SECTION_TAGS:"DELETE_SECTION_TAGS",INIT_DELETE_SITE_SECTIONS_TAGS:"INIT_DELETE_SITE_SECTIONS_TAGS",DELETE_SITE_SECTIONS_TAGS:"DELETE_SITE_SECTIONS_TAGS",ADD_SITE_SECTIONS_ENTRIES:"ADD_SITE_SECTIONS_ENTRIES",ADD_SECTION_ENTRIES:"ADD_SECTION_ENTRIES",INIT_UPDATE_SECTION_ENTRY:"INIT_UPDATE_SECTION_ENTRY",UPDATE_SECTION_ENTRY:"UPDATE_SECTION_ENTRY",INIT_UPDATE_SECTION_ENTRIES:"INIT_UPDATE_SECTION_ENTRIES",RENAME_SECTION_ENTRIES_SITENAME:"RENAME_SECTION_ENTRIES_SITENAME",RENAME_SECTION_ENTRIES:"RENAME_SECTION_ENTRIES",INIT_ORDER_SECTION_ENTRIES:"INIT_ORDER_SECTION_ENTRIES",ORDER_SECTION_ENTRIES:"ORDER_SECTION_ENTRIES",INIT_ORDER_SECTION_ENTRY_GALLERY:"INIT_ORDER_SECTION_ENTRY_GALLERY",ORDER_SECTION_ENTRY_GALLERY:"ORDER_SECTION_ENTRY_GALLERY",INIT_DELETE_ENTRY_GALLERY_IMAGE:"INIT_DELETE_ENTRY_GALLERY_IMAGE",DELETE_ENTRY_GALLERY_IMAGE:"DELETE_ENTRY_GALLERY_IMAGE",INIT_DELETE_SECTION_ENTRY:"INIT_DELETE_SECTION_ENTRY",DELETE_SECTION_ENTRY:"DELETE_SECTION_ENTRY",INIT_DELETE_SITE_SECTIONS_ENTRIES:"INIT_DELETE_SITE_SECTIONS_ENTRIES",DELETE_SITE_SECTIONS_ENTRIES:"DELETE_SITE_SECTIONS_ENTRIES",INIT_DELETE_SECTION_ENTRIES:"INIT_DELETE_SECTION_ENTRIES",DELETE_SECTION_ENTRIES:"DELETE_SECTION_ENTRIES"}}(window),function(e,t,n,E){"use strict";e.Actions=e.Actions||{},Object.assign(e.Actions,{getState:function(t){t=t?t:"0";var i="/_api/v1/state/"+t;return function(t){t({type:n.GET_STATE}),E(i,{},"GET").then(function(n){n.error_message||t(e.Actions.setState(n))})}},setState:function(e){return t.urls=e.urls,{type:n.SET_STATE,state:e}}})}(window,window.Berta,window.ActionTypes,window.sync),function(e,t,n){"use strict";var E=e.Actions=e.Actions||{};Object.assign(e.Actions,{initCreateSite:function(i,T){return function(r){r({type:t.INIT_CREATE_SITE}),n(e.Berta.urls.sites,{site:i},"POST").then(function(e){if(e.error_message);else{if(r(E.createSite(e.site)),e.settings&&r(E.createSiteSettings(e.site.name,e.settings)),e.sections&&e.sections.length)for(var t=0;t<e.sections.length;t++)r(E.createSiteSection(e.sections[t]));e.entries&&e.entries.length&&r(E.addSiteSectionsEntries({site_name:e.site.name,entries:e.entries})),e.tags&&e.tags.section&&r(E.addSiteSectionsTags({site_name:e.site.name,tags:e.tags})),e.siteTemplateSettings&&r(E.createSiteTemplateSettings(e.site.name,e.siteTemplateSettings))}T(e.site)})}},createSite:function(e){return{type:t.CREATE_SITE,data:e}},initUpdateSite:function(i,T,r){return function(S){S({type:t.INIT_UPDATE_SITE}),n(e.Berta.urls.sites,{path:i,value:T}).then(function(e){e.error_message||S(E.updateSite(e)),r(e)})}},updateSite:function(e){return{type:t.UPDATE_SITE,resp:e}},renameSite:function(i,T,r){return function(S,a){S({type:t.INIT_UPDATE_SITE}),S({type:t.INIT_UPDATE_SITE_SECTION}),S({type:t.INIT_UPDATE_SITE_SETTINGS}),S({type:t.INIT_UPDATE_SITE_TEMPLATE_SETTINGS}),S({type:t.INIT_UPDATE_SECTION_TAGS}),S({type:t.INIT_UPDATE_SECTION_ENTRIES}),n(e.Berta.urls.sites,{path:i,value:T}).then(function(e){if(e.error_message);else{i=i.split("/");var t=parseInt(i[1],10),n=a().sites.find(function(e){return e.get("order")===t});S(E.updateSite(e)),S(E.renameSiteSectionsSitename({site:n,site_name:e.value})),S(E.renameSiteSettingsSitename({site:n,site_name:e.value})),S(E.renameSiteTemplateSettingsSitename({site:n,site_name:e.value})),S(E.renameSectionTagsSitename({site:n,site_name:e.value})),S(E.renameSectionEntriesSitename({site:n,site_name:e.value}))}r(e)})}},initOrderSites:function(i,T){return function(r){r({type:t.INIT_ORDER_SITES}),n(e.Berta.urls.sites,i,"PUT").then(function(e){e.error_message||r(E.orderSites(i)),T(e)})}},orderSites:function(e){return{type:t.ORDER_SITES,resp:e}},initdeleteSite:function(i,T){return function(r){r({type:t.INIT_DELETE_SITE}),r({type:t.INIT_DELETE_SITE_SECTIONS}),r({type:t.INIT_DELETE_SITE_SETTINGS}),r({type:t.INIT_DELETE_SITE_TEMPLATE_SETTINGS}),r({type:t.INIT_DELETE_SITE_SECTIONS_TAGS}),r({type:t.INIT_DELETE_SITE_SECTIONS_ENTRIES}),n(e.Berta.urls.sites,{site:i},"DELETE").then(function(e){e.error_message||(r(E.deleteSite(e)),r(E.deleteSiteSections({site_name:e.name})),r(E.deleteSiteSettings({site_name:e.name})),r(E.deleteSiteTemplateSettings({site_name:e.name})),r(E.deleteSiteSectionsTags({site_name:e.name})),r(E.deleteSiteSectionsEntries({site_name:e.name}))),T(e)})}},deleteSite:function(e){return{type:t.DELETE_SITE,resp:e}}})}(window,window.ActionTypes,window.sync),function(e,t,n){"use strict";e.reducers=e.reducers||{},Object.assign(e.reducers,{sites:function(e,E){var i,T,r;switch(void 0===e&&(e=t.Map()),E.type){case n.SET_STATE:return t.fromJS(E.state.sites);case n.CREATE_SITE:return e.set(e.size,t.fromJS(E.data));case n.UPDATE_SITE:i=E.resp.path.split("/"),r=parseInt(i[1],10),T=E.resp.value;var S=i.slice(2);return e.map(function(e){return e.get("order")===r&&e.getIn(S)!==T?e.setIn(S,T):e});case n.ORDER_SITES:return e.map(function(e){var t=e.get("name");""===t&&(t="0");var n=E.resp.indexOf(t);return e.get("order")!==n?e.set("order",n):e});case n.DELETE_SITE:return e.filter(function(e){return e.get("name")!==E.resp.name}).map(function(e,t){return e.get("order")!==t?e.set("order",t):e});default:return e}}})}(window,window.Immutable,window.ActionTypes),function(e,t,n){"use strict";var E=e.Actions=e.Actions||{};Object.assign(e.Actions,{createSiteSettings:function(e,n){return{type:t.CREATE_SITE_SETTINGS,site_name:e,data:n}},initUpdateSiteSettings:function(i,T,r){return function(S){S({type:t.INIT_UPDATE_SITE_SETTINGS}),n(e.Berta.urls.siteSettings,{path:i,value:T}).then(function(e){e.error_message||S(E.updateSiteSettings(e)),r(e)})}},updateSiteSettings:function(e){return{type:t.UPDATE_SITE_SETTINGS,resp:e}},renameSiteSettingsSitename:function(e){return{type:t.RENAME_SITE_SETTINGS_SITENAME,data:e}},deleteSiteSettings:function(e){return{type:t.DELETE_SITE_SETTINGS,data:e}}})}(window,window.ActionTypes,window.sync),function(e,t,n){"use strict";e.reducers=e.reducers||{},Object.assign(e.reducers,{siteSettings:function(e,E){switch(void 0===e&&(e=t.Map()),E.type){case n.SET_STATE:return t.fromJS(E.state.site_settings);case n.CREATE_SITE_SETTINGS:return e.setIn([E.site_name],t.fromJS(E.data));case n.UPDATE_SITE_SETTINGS:var i=E.resp.path.split("/").slice(2),T=E.resp.value;return e.setIn([E.resp.site,i[0],i[1]],T);case n.RENAME_SITE_SETTINGS_SITENAME:var r=E.data.site.get("name");return e.mapKeys(function(e){return e===r?E.data.site_name:e});case n.DELETE_SITE_SETTINGS:return e.filter(function(e,t){return t!==E.data.site_name});default:return e}}})}(window,window.Immutable,window.ActionTypes),function(e,t,n){"use strict";var E=e.Actions=e.Actions||{};Object.assign(e.Actions,{createSiteTemplateSettings:function(e,n){return{type:t.CREATE_SITE_TEMPLATE_SETTINGS,site_name:e,data:n}},initUpdateSiteTemplateSettings:function(i,T,r){return function(S){S({type:t.INIT_UPDATE_SITE_TEMPLATE_SETTINGS}),n(e.Berta.urls.siteTemplateSettings,{path:i,value:T}).then(function(e){e.error_message||S(E.updateSiteTemplateSettings(e)),r(e)})}},updateSiteTemplateSettings:function(e){return{type:t.UPDATE_SITE_TEMPLATE_SETTINGS,resp:e}},renameSiteTemplateSettingsSitename:function(e){return{type:t.RENAME_SITE_TEMPLATE_SETTINGS_SITENAME,data:e}},deleteSiteTemplateSettings:function(e){return{type:t.DELETE_SITE_TEMPLATE_SETTINGS,data:e}}})}(window,window.ActionTypes,window.sync),function(e,t,n){"use strict";e.reducers=e.reducers||{},Object.assign(e.reducers,{siteTemplateSettings:function(e,E){switch(void 0===e&&(e=t.Map()),E.type){case n.SET_STATE:return t.fromJS(E.state.site_template_settings);case n.CREATE_SITE_TEMPLATE_SETTINGS:return e.setIn([E.site_name],t.fromJS(E.data));case n.UPDATE_SITE_TEMPLATE_SETTINGS:var i=E.resp.path.split("/").slice(2),T=E.resp.value;return e.setIn([E.resp.site,i[0],i[1],i[2]],T);case n.RENAME_SITE_TEMPLATE_SETTINGS_SITENAME:var r=E.data.site.get("name");return e.mapKeys(function(e){return e===r?E.data.site_name:e});case n.DELETE_SITE_TEMPLATE_SETTINGS:return e.filter(function(e,t){return t!==E.data.site_name});default:return e}}})}(window,window.Immutable,window.ActionTypes),function(e,t,n){"use strict";var E=e.Actions=e.Actions||{};Object.assign(e.Actions,{initCreateSiteSection:function(i,T,r,S){return function(a){a({type:t.INIT_CREATE_SITE_SECTION}),a({type:t.INIT_UPDATE_SECTION_TAGS}),n(e.Berta.urls.siteSections,{site:i,name:T,title:r},"POST").then(function(e){e.error_message||(a(E.createSiteSection(e.section)),e.tags&&a(E.addSectionTags({site_name:i,tags:e.tags})),e.entries&&a(E.addSectionEntries({site_name:i,entries:e.entries}))),S(e.section)})}},createSiteSection:function(e){return{type:t.CREATE_SITE_SECTION,resp:e}},initUpdateSiteSection:function(i,T,r){return function(S){S({type:t.INIT_UPDATE_SITE_SECTION}),n(e.Berta.urls.siteSections,{path:i,value:T}).then(function(e){e.error_message||S(E.updateSiteSection(e)),r(e)})}},updateSiteSection:function(e){return{type:t.UPDATE_SITE_SECTION,resp:e}},initRenameSiteSection:function(i,T,r){return function(S){S({type:t.INIT_UPDATE_SITE_SECTION}),S({type:t.INIT_UPDATE_SECTION_TAGS}),S({type:t.INIT_UPDATE_SECTION_ENTRIES}),n(e.Berta.urls.siteSections,{path:i,value:T}).then(function(e){e.error_message||(S(E.updateSiteSection(e)),S(E.renameSectionTags({site_name:e.site,section_name:e.section.name,section_old_name:e.old_name})),S(E.renameSectionEntries({site_name:e.site,section_name:e.section.name,section_old_name:e.old_name}))),r(e)})}},renameSiteSectionsSitename:function(e){return{type:t.RENAME_SITE_SECTIONS_SITENAME,data:e}},resetSiteSection:function(E,i){return function(T){T({type:t.RESET_SITE_SECTION,path:E}),n(e.Berta.urls.siteSectionsReset,{path:E}).then(function(e){e.error_message,i(e)})}},initOrderSiteSections:function(i,T,r){return function(S){S({type:t.INIT_ORDER_SITE_SECTIONS}),n(e.Berta.urls.siteSections,{site:i,sections:T},"PUT").then(function(e){e.error_message||S(E.orderSiteSections({site:i,sections:T})),r(e)})}},orderSiteSections:function(e){return{type:t.ORDER_SITE_SECTIONS,resp:e}},initDeleteSiteSection:function(i,T,r){return function(S){S({type:t.INIT_DELETE_SITE_SECTION}),S({type:t.INIT_UPDATE_SECTION_TAGS}),S({type:t.INIT_DELETE_SECTION_ENTRIES}),n(e.Berta.urls.siteSections,{site:i,section:T},"DELETE").then(function(e){e.error_message||(S(E.deleteSiteSection(e)),S(E.deleteSectionTags({site_name:e.site,section_name:e.name})),S(E.deleteSectionEntries({site_name:e.site,section_name:e.name}))),r(e)})}},deleteSiteSection:function(e){return{type:t.DELETE_SITE_SECTION,resp:e}},deleteSiteSections:function(e){return{type:t.DELETE_SITE_SECTIONS,data:e}},initOrderSiteSectionBackgrounds:function(i,T,r,S){return function(a){a({type:t.INIT_ORDER_SITE_SECTION_BACKGROUNDS}),n(e.Berta.urls.siteSectionBackgrounds,{site:i,section:T,files:r},"PUT").then(function(e){e.error_message||a(E.orderSiteSectionBackgrounds(e)),S(e)})}},orderSiteSectionBackgrounds:function(e){return{type:t.ORDER_SITE_SECTION_BACKGROUNDS,resp:e}},initDeleteSiteSectionBackground:function(i,T,r,S){return function(a){a({type:t.INIT_DELETE_SITE_SECTION_BACKGROUND}),n(e.Berta.urls.siteSectionBackgrounds,{site:i,section:T,file:r},"DELETE").then(function(e){e.error_message||a(E.deleteSiteSectionBackground(e)),S(e)})}},deleteSiteSectionBackground:function(e){return{type:t.DELETE_SITE_SECTION_BACKGROUND,resp:e}}})}(window,window.ActionTypes,window.sync),function(e,t,n){"use strict";e.reducers=e.reducers||{},Object.assign(e.reducers,{siteSections:function(e,E){var i,T,r,S,a;switch(void 0===e&&(e=t.Map()),E.type){case n.SET_STATE:return t.fromJS(E.state.site_sections);case n.CREATE_SITE_SECTION:return e.set(e.size,t.fromJS(E.resp));case n.UPDATE_SITE_SECTION:return i=E.resp.path.split("/"),T="0"===i[0]?"":i[0],r=parseInt(i[2],10),a=E.resp.value,S=i.slice(3),e.map(function(e){return e.get("site_name")===T&&e.get("order")===r&&e.getIn(S)!==a?e.merge(E.resp.section):e});case n.RENAME_SITE_SECTIONS_SITENAME:var s=E.data.site.get("name");return a=E.data.site_name,e.map(function(e){return e.get("site_name")===s?e.set("site_name",a):e});case n.RESET_SITE_SECTION:return i=E.path.split("/"),T="0"===i[0]?"":i[0],r=parseInt(i[2],10),S=i.slice(3),e.map(function(e){return e.get("site_name")===T&&e.get("order")===r?e.deleteIn(S):e});case n.ORDER_SITE_SECTIONS:return e.map(function(e){if(e.get("site_name")===E.resp.site){var t=E.resp.sections.indexOf(e.get("name"));if(e.get("order")!==t)return e.set("order",t)}return e});case n.DELETE_SITE_SECTION:return T="0"===E.resp.site?"":E.resp.site,r=-1,e.filter(function(e){return!(e.get("name")===E.resp.name&&e.get("site_name")===T)}).map(function(e){return e.get("site_name")===T&&(r++,e.get("order")!==r)?e.set("order",r):e});case n.DELETE_SITE_SECTIONS:return e.filter(function(e){return e.get("site_name")!==E.data.site_name});case n.ORDER_SITE_SECTION_BACKGROUNDS:return e.map(function(e){return e.get("site_name")===E.resp.site&&e.get("name")===E.resp.section?e.set("mediafolder",E.resp.mediafolder).setIn(["mediaCacheData","file"],E.resp.files):e});default:return e}}})}(window,window.Immutable,window.ActionTypes),function(e,t,n){"use strict";var E=e.Actions=e.Actions||{};Object.assign(e.Actions,{addSiteSectionsTags:function(e){return{type:t.ADD_SITE_SECTIONS_TAGS,data:e}},addSectionTags:function(e){return{type:t.ADD_SECTION_TAGS,data:e}},initOrderSectionTags:function(i,T,r,S,a){return function(s){s({type:t.INIT_ORDER_SECTION_TAGS}),n(e.Berta.urls.sectionTags,{site:i,section:T,tag:r,value:S},"PUT").then(function(e){e.error_message||s(E.orderSectionTags(e)),a()})}},orderSectionTags:function(e){return{type:t.ORDER_SECTION_TAGS,data:e}},renameSectionTags:function(e){return{type:t.RENAME_SECTION_TAGS,data:e}},updateSectionTags:function(e){return{type:t.UPDATE_SECTION_TAGS,data:e}},renameSectionTagsSitename:function(e){return{type:t.RENAME_SECTION_TAGS_SITENAME,data:e}},deleteSectionTags:function(e){return{type:t.DELETE_SECTION_TAGS,data:e}},deleteSiteSectionsTags:function(e){return{type:t.DELETE_SITE_SECTIONS_TAGS,data:e}}})}(window,window.ActionTypes,window.sync),function(e,t,n){"use strict";e.reducers=e.reducers||{},Object.assign(e.reducers,{sectionTags:function(e,E){var i=[];switch(void 0===e&&(e=t.Map()),E.type){case n.SET_STATE:return t.fromJS(E.state.section_tags);case n.ADD_SITE_SECTIONS_TAGS:return e.set(E.data.site_name,E.data.tags);case n.ADD_SECTION_TAGS:return e.map(function(e,n){return E.data.site_name===n?e.map(function(e){return e.set(e.size,t.fromJS(E.data.tags))}):e});case n.ORDER_SECTION_TAGS:return i="0"===E.data.site_name?"":E.data.site_name,e.map(function(e,t){return i===t?e.map(function(e){return e.map(function(e){if(e.getIn(["@attributes","name"])===E.data.section_name){var t=e.get("tag").map(function(e){return e.set("order",E.data.order.indexOf(e.getIn(["@attributes","name"])))});return e.set("tag",t)}return e})}):e});case n.UPDATE_SECTION_TAGS:return i="0"===E.data.site_name?"":E.data.site_name,e.map(function(e,t){return i===t?e.map(function(e){return e.map(function(e){return e.getIn(["@attributes","name"])===E.data.section_name?e.merge(E.data.tags.tags):e})}):e});case n.RENAME_SECTION_TAGS:return i="0"===E.data.site_name?"":E.data.site_name,e.map(function(e,t){return i===t?e.map(function(e){return e.map(function(e){return e.getIn(["@attributes","name"])===E.data.section_old_name?e.setIn(["@attributes","name"],E.data.section_name):e})}):e});case n.RENAME_SECTION_TAGS_SITENAME:var T=E.data.site.get("name");return e.mapKeys(function(e){return e===T?E.data.site_name:e});case n.DELETE_SECTION_TAGS:return i="0"===E.data.site_name?"":E.data.site_name,e.map(function(e,t){return i===t?e.map(function(e){return e.filter(function(e){return e.getIn(["@attributes","name"])!==E.data.section_name})}):e});case n.DELETE_SITE_SECTIONS_TAGS:return e.filter(function(e,t){return t!==E.data.site_name});default:return e}}})}(window,window.Immutable,window.ActionTypes),function(e,t,n,E){"use strict";e.Actions=e.Actions||{},Object.assign(e.Actions,{addSiteSectionsEntries:function(e){return{type:E.ADD_SITE_SECTIONS_ENTRIES,data:e}},addSectionEntries:function(e){return{type:E.ADD_SECTION_ENTRIES,data:e}},initUpdateSectionEntry:function(i,T,r){return function(S){S({type:E.INIT_UPDATE_SECTION_ENTRY}),t(e.Berta.urls.sectionEntries,{path:i,value:T}).then(function(e){e.error_message||(S(n.updateSectionEntry(e)),e.section&&(S({type:E.INIT_UPDATE_SITE_SECTION}),S(n.updateSiteSection({path:e.site_name+"/section/"+e.section_order+"/@attributes/has_direct_content",section:e.section,value:e.has_direct_content}))),e.tags&&S(n.updateSectionTags(e))),r&&r(e)})}},updateSectionEntry:function(e){return{type:E.UPDATE_SECTION_ENTRY,resp:e}},renameSectionEntriesSitename:function(e){return{type:E.RENAME_SECTION_ENTRIES_SITENAME,data:e}},renameSectionEntries:function(e){return{type:E.RENAME_SECTION_ENTRIES,data:e}},initOrderSectionEntries:function(i,T,r,S){return function(a){a({type:E.INIT_ORDER_SECTION_ENTRIES}),t(e.Berta.urls.sectionEntries,{site:i,section:T,entryId:r,value:S},"PUT").then(function(e){e.error_message||a(n.orderSectionEntries(e))})}},orderSectionEntries:function(e){return{type:E.ORDER_SECTION_ENTRIES,data:e}},initDeleteSectionEntry:function(i,T,r,S){return function(a){a({type:E.INIT_DELETE_SECTION_ENTRY}),a({type:E.INIT_UPDATE_SITE_SECTION}),t(e.Berta.urls.sectionEntries,{site:i,section:T,entryId:r},"DELETE").then(function(e){e.error_message||(a(n.deleteSectionEntry(e)),a(n.updateSiteSection({path:e.site_name+"/section/"+e.section_order+"/@attributes/entry_count",section:e.section,value:e.entry_count})),a(n.updateSiteSection({path:e.site_name+"/section/"+e.section_order+"/@attributes/has_direct_content",section:e.section,value:e.has_direct_content})),a(n.updateSectionTags(e))),S(e)})}},deleteSectionEntry:function(e){return{type:E.DELETE_SECTION_ENTRY,resp:e}},deleteSiteSectionsEntries:function(e){return{type:E.DELETE_SITE_SECTIONS_ENTRIES,data:e}},deleteSectionEntries:function(e){return{type:E.DELETE_SECTION_ENTRIES,data:e}},initOrderSectionEntryGallery:function(i,T,r,S,a){return function(s){s({type:E.INIT_ORDER_SECTION_ENTRY_GALLERY}),t(e.Berta.urls.entryGallery,{site:i,section:T,entryId:r,files:S},"PUT").then(function(e){e.error_message||s(n.orderSectionEntryGallery(e)),a(e)})}},orderSectionEntryGallery:function(e){return{type:E.ORDER_SECTION_ENTRY_GALLERY,resp:e}},initDeleteEntryGalleryImage:function(i,T,r,S,a){return function(s){s({type:E.INIT_DELETE_ENTRY_GALLERY_IMAGE}),t(e.Berta.urls.entryGallery,{site:i,section:T,entryId:r,file:S},"DELETE").then(function(e){e.error_message||s(n.deleteEntryGalleryImage(e)),a(e)})}},deleteEntryGalleryImage:function(e){return{type:E.DELETE_ENTRY_GALLERY_IMAGE,resp:e}}})}(window,window.sync,window.Actions,window.ActionTypes),function(e,t,n){"use strict";e.reducers=e.reducers||{},Object.assign(e.reducers,{sectionEntries:function(e,E){var i;switch(void 0===e&&(e=t.Map()),E.type){case n.SET_STATE:return t.fromJS(E.state.sectionEntries);case n.ADD_SITE_SECTIONS_ENTRIES:return e.set(E.data.site_name,E.data.entries);case n.ADD_SECTION_ENTRIES:return e.map(function(e,n){return n===E.data.site_name?e.concat(t.fromJS(E.data.entries)):e});case n.UPDATE_SECTION_ENTRY:var T=E.resp.path.split("/"),r="0"===T[0]?"":T[0],S=T[2],a=T[3],s=e.get(r).findIndex(function(e){return e.get("id")===a&&e.get("sectionName")===S});return s<0?e:e.setIn([r,s],e.getIn([r,s]).merge(E.resp.entry));case n.RENAME_SECTION_ENTRIES_SITENAME:var _=E.data.site.get("name");return e.mapKeys(function(e){return e===_?E.data.site_name:e});case n.RENAME_SECTION_ENTRIES:return i="0"===E.data.site_name?"":E.data.site_name,e.map(function(e,t){return i===t?e.map(function(e){return e.get("sectionName")===E.data.section_old_name?e.set("sectionName",E.data.section_name):e}):e});case n.ORDER_SECTION_ENTRIES:return i="0"===E.data.site_name?"":E.data.site_name,e.map(function(e,t){return i===t?e.map(function(e){return e.get("sectionName")===E.data.section_name?e.set("order",E.data.order.indexOf(e.get("id"))):e}):e});case n.DELETE_SECTION_ENTRY:return i="0"===E.resp.site_name?"":E.resp.site_name,e.map(function(e,t){return i===t?e.filter(function(e){return!(e.get("sectionName")===E.resp.section_name&&e.get("id")===E.resp.entry_id)}).map(function(e){return e.get("sectionName")===E.resp.section_name&&e.get("order")>E.resp.entry_order?e.set("order",e.get("order")-1):e}):e});case n.DELETE_SITE_SECTIONS_ENTRIES:return e.filter(function(e,t){return t!==E.data.site_name});case n.DELETE_SECTION_ENTRIES:return i="0"===E.data.site_name?"":E.data.site_name,e.map(function(e,t){return i===t?e.filter(function(e){return e.get("sectionName")!==E.data.section_name}):e});case n.ORDER_SECTION_ENTRY_GALLERY:return e.map(function(e,t){return t===E.resp.site?e.map(function(e){return e.get("sectionName")===E.resp.section&&e.get("id")===E.resp.entry_id?e.set("mediafolder",E.resp.mediafolder).setIn(["mediaCacheData","file"],E.resp.files):e}):e});default:return e}}})}(window,window.Immutable,window.ActionTypes),function(e,t,n){"use strict";e.reducers=e.reducers||{},Object.assign(e.reducers,{siteTemplates:function(e,E){switch(void 0===e&&(e=t.Map()),E.type){case n.SET_STATE:return t.fromJS(E.state.siteTemplates);default:return e}}})}(window,window.Immutable,window.ActionTypes),function(e,t,n){"use strict";e.root_reducer=t.combineReducers(n)}(window,window.Redux,window.reducers),function(e,t,n,E,i,T,r){"use strict";T(i.load);var S=e.__REDUX_DEVTOOLS_EXTENSION_COMPOSE__||t.compose;e.redux_store=t.createStore(e.root_reducer,{},S(t.applyMiddleware(n["default"])));var a=r();e.redux_store.dispatch(E.getState(a))}(window,window.Redux,window.ReduxThunk,window.Actions,window.Templates,window.domReady,window.getCurrentSite);
//# sourceMappingURL=maps/ng-backend.min.js.map
